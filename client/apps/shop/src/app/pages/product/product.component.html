<ng-container *ngIf="data$ | async as data">

  <!--Product name-->
  <section class="bg-primary c-l-primary jfs-product-header">
    <div class="grid">
      <div class="col-6 col-xs-12">
        <h3 class="fw-reg c-l-primary m-b-xs">{{data.product.name}}</h3>
        <p>{{data.product.shortDescription}}</p>
      </div>
      <div class="col-6 col-xs-12 ws-nowrap ta-right">
        <mat-icon>star</mat-icon>
        <mat-icon>star</mat-icon>
        <mat-icon>star</mat-icon>
        <mat-icon>star</mat-icon>
        <mat-icon>star</mat-icon>
        <p><a class="link">5 reviews</a></p>
      </div>
    </div>
  </section>

  <!--Product details-->
  <section class="grid">
    <div class="col-12">
      <mat-card class="p-a-0">
        <div class="grid">
          <div class="col-6 col-s-12">
            <h5 class="p-t-s p-b-xs">Description</h5>
            <div [innerHtml]="data.product.description"></div>
            <h2 class="m-t-m m-b-xs">{{data.product.price | currency}}</h2>
            <ng-container *ngIf="data.quantity; else notInCart">
              <button
                mat-flat-button
                color="accent"
                (click)="cart.add(data.product, null)">
                <span class="iblock p-x-s">Add more to cart (currently {{data.quantity}})</span>
              </button>
            </ng-container>
            <ng-template #notInCart>
              <button
                mat-flat-button
                color="accent"
                (click)="cart.add(data.product, null)">
                <span class="iblock p-x-m">Add to cart</span>
              </button>
            </ng-template>
          </div>
          <div class="col-6 col-s-12">
            <img class="w-full" src="assets/images/loading.svg" [jpPreload]="data.product.gallery[0]" />
            <div class="jfs-gallery">
              <img
                class="jfs-gallery-image active"
                *ngFor="let img of data.product.gallery"
                src="assets/images/loading.svg"
                [jpPreload]="img"
              />
            </div>
          </div>
        </div>
        <button
          class="jfs-wishlist-button"
          mat-mini-fab
          color="accent"
          [matTooltip]="data.wishList.tooltip"
          [attr.aria-label]="data.wishList.tooltip"
          (click)="wishList.toggle(data.product.id)">
          <mat-icon>{{data.wishList.icon}}</mat-icon>
        </button>
      </mat-card>

    </div>
  </section>

  <!--Similar products-->
  <section class="grid">
    <div class="col-12">
      <h6>Similar products</h6>
      <div *ngIf="similar$ | async as similarProducts">
        <ng-container *ngFor="let next of similarProducts">
          <jfs-product-card [product]="next"></jfs-product-card>
        </ng-container>
      </div>
    </div>
    <div class="col-12">
      <h6>Reviews</h6>
      <ng-container *ngIf="(rews$ | async) as rec">
        <ng-container *ngIf="rec.length; else empty">
          <div *ngFor="let review of rec">
            <jfs-review-card [review]="review"></jfs-review-card>
          </div>
        </ng-container>
      </ng-container>
    </div>
  </section>

</ng-container>
